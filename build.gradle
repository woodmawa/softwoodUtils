plugins {
    id 'groovy'
    id 'java'
    id 'maven-publish'

}

group 'com.softwood'
version '1.0-SNAPSHOT'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
    mavenLocal()
    maven { url 'https://oss.sonatype.org/content/repositories/snapshots/' }

}

dependencies {

    //implementation replaces compile and is not transitevly resolved, API is transitively resolved
    //compile 'org.codehaus.groovy:groovy-all:2.5.8'
    implementation group: 'org.codehaus.groovy', name: 'groovy-all', version: '3.0.0-beta-3' //, ext: 'pom'
    //spock not ready for groovy 3 beta

    testImplementation group: 'junit', name: 'junit', version: '4.12'
    implementation group: 'com.fasterxml.uuid', name: 'java-uuid-generator', version: '3.2.0'
    implementation group: 'io.vertx', name: 'vertx-core', version: '3.5.3'
    implementation group: 'javax.inject', name: 'javax.inject', version: '1'
    testImplementation (group: 'org.spockframework', name: 'spock-core', version: '1.3-groovy-2.5-SNAPSHOT') /*{
        exclude group: 'org.codehaus.groovy', name: 'groovy-all'
    }*/

    //
    implementation 'com.github.seancfoley:ipaddress:5.0.2'  //ipv4 & v6 handling library, better options than JDK

}

//should include java and groovy
task sourceJar (type : Jar) {
    from sourceSets.main.allGroovy
    classifier "sources"
}

publishing {
    publications {
        mavenGroovy(MavenPublication) {
            from components.java
           artifact (sourceJar) {
                classifier = 'sources'
            }
            // more goes in here
        }
    }
    repositories {
        mavenLocal()
    }
} 

/*
gradle 5 add this directly it seems
task wrapper (type: Wrapper) {
    gradleVersion = '4.10'
}*/